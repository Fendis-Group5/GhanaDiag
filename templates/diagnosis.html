{% extends "base.html" %}

{% block title %}Health Assessment Results - Automated Diagnostic System (ADS){% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-8">
        <div class="flex items-center justify-center space-x-3 mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-ice-500 to-ice-600 rounded-xl flex items-center justify-center">
                <i data-feather="file-text" class="w-7 h-7 text-white"></i>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold text-winter-800 dark:text-winter-100">Assessment Results</h1>
        </div>
    </div>

    <!-- Patient Information -->
    {% if submission.name or submission.age or submission.gender or submission.location %}
    <div class="bg-white/60 dark:bg-winter-800/60 backdrop-blur-sm rounded-xl border border-winter-200 dark:border-winter-700 p-6 mb-6">
        <h2 class="text-lg font-semibold text-winter-800 dark:text-winter-100 mb-4 flex items-center">
            <i data-feather="user" class="w-5 h-5 mr-2 text-ice-600"></i>
            Patient Information
        </h2>
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm">
            {% if submission.name %}
            <div>
                <span class="font-medium text-winter-700 dark:text-winter-300">Name:</span>
                <span class="text-winter-600 dark:text-winter-400 ml-1">{{ submission.name }}</span>
            </div>
            {% endif %}
            {% if submission.age %}
            <div>
                <span class="font-medium text-winter-700 dark:text-winter-300">Age:</span>
                <span class="text-winter-600 dark:text-winter-400 ml-1">{{ submission.age }} years</span>
            </div>
            {% endif %}
            {% if submission.gender %}
            <div>
                <span class="font-medium text-winter-700 dark:text-winter-300">Gender:</span>
                <span class="text-winter-600 dark:text-winter-400 ml-1">{{ submission.gender.title() }}</span>
            </div>
            {% endif %}
            {% if submission.location %}
            <div>
                <span class="font-medium text-winter-700 dark:text-winter-300">Location:</span>
                <span class="text-winter-600 dark:text-winter-400 ml-1">{{ submission.location }}</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Symptoms Summary -->
    <div class="bg-white/60 dark:bg-winter-800/60 backdrop-blur-sm rounded-xl border border-winter-200 dark:border-winter-700 p-6 mb-6">
        <h2 class="text-lg font-semibold text-winter-800 dark:text-winter-100 mb-4 flex items-center">
            <i data-feather="list" class="w-5 h-5 mr-2 text-ice-600"></i>
            Reported Symptoms
        </h2>
        
        {% if submission.symptoms_selected %}
        <div class="mb-4">
            <h3 class="font-medium text-winter-700 dark:text-winter-300 mb-2">Selected symptoms:</h3>
            <div class="flex flex-wrap gap-2">
                {% for symptom in submission.symptoms_selected %}
                <span class="bg-ice-100 dark:bg-ice-900/30 text-ice-800 dark:text-ice-200 px-3 py-1 rounded-full text-sm">
                    {{ symptom.replace('_', ' ').title() }}
                </span>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        {% if submission.symptoms_text %}
        <div>
            <h3 class="font-medium text-winter-700 dark:text-winter-300 mb-2">Additional description:</h3>
            <p class="text-winter-600 dark:text-winter-400 bg-winter-50 dark:bg-winter-700/50 p-3 rounded-lg">
                "{{ submission.symptoms_text }}"
            </p>
        </div>
        {% endif %}
    </div>

    <!-- Assessment Summary -->
    <div class="bg-white/60 dark:bg-winter-800/60 backdrop-blur-sm rounded-xl border border-winter-200 dark:border-winter-700 p-6 mb-6">
        <h2 class="text-lg font-semibold text-winter-800 dark:text-winter-100 mb-4 flex items-center">
            <i data-feather="activity" class="w-5 h-5 mr-2 text-ice-600"></i>
            Assessment Summary
        </h2>
        <div class="bg-ice-50 dark:bg-ice-900/20 border border-ice-200 dark:border-ice-800 rounded-lg p-4">
            <p class="text-ice-800 dark:text-ice-200 font-medium">{{ diagnosis.message }}</p>
        </div>
    </div>

    <!-- Possible Conditions -->
    {% if diagnosis.diagnoses %}
    <div class="space-y-6 mb-8">
        {% for condition in diagnosis.diagnoses %}
        <div class="bg-white/60 dark:bg-winter-800/60 backdrop-blur-sm rounded-xl border border-winter-200 dark:border-winter-700 p-6">
            <div class="flex items-start justify-between mb-4">
                <div class="flex-1">
                    <h3 class="text-xl font-semibold text-winter-800 dark:text-winter-100 mb-2">
                        {{ condition.condition }}
                    </h3>
                    <p class="text-winter-600 dark:text-winter-400 mb-3">{{ condition.description }}</p>
                </div>

            </div>

            <!-- Urgency Badge -->
            <div class="mb-4">
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                    {% if condition.urgency == 'urgent' %}bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300
                    {% elif condition.urgency == 'high' %}bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300
                    {% elif condition.urgency == 'medium' %}bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300
                    {% else %}bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300{% endif %}">
                    <i data-feather="
                        {% if condition.urgency == 'urgent' %}alert-triangle
                        {% elif condition.urgency == 'high' %}alert-circle
                        {% elif condition.urgency == 'medium' %}clock
                        {% else %}check-circle{% endif %}" class="w-4 h-4 mr-1"></i>
                    {% if condition.urgency == 'urgent' %}Urgent - See doctor immediately
                    {% elif condition.urgency == 'high' %}High priority - See doctor soon
                    {% elif condition.urgency == 'medium' %}Medium priority - Monitor symptoms
                    {% else %}Low priority - Self-care may help{% endif %}
                </span>
            </div>

            <!-- Matched Symptoms -->
            {% if condition.matched_symptoms %}
            <div class="mb-4">
                <h4 class="font-medium text-winter-700 dark:text-winter-300 mb-2">Matching symptoms:</h4>
                <div class="flex flex-wrap gap-2">
                    {% for symptom in condition.matched_symptoms %}
                    <span class="bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 px-2 py-1 rounded text-sm">
                        {{ symptom.replace('_', ' ').title() }}
                    </span>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Recommendations -->
            <div>
                <h4 class="font-medium text-winter-700 dark:text-winter-300 mb-3 flex items-center">
                    <i data-feather="clipboard" class="w-4 h-4 mr-2"></i>
                    Recommended Actions:
                </h4>
                <ul class="space-y-2">
                    {% for recommendation in condition.recommendations %}
                    <li class="flex items-start">
                        <i data-feather="chevron-right" class="w-4 h-4 text-ice-600 mr-2 mt-0.5 flex-shrink-0"></i>
                        <span class="text-winter-600 dark:text-winter-400">{{ recommendation }}</span>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Important Disclaimer -->
    <div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-6 mb-8">
        <div class="flex items-start">
            <i data-feather="alert-triangle" class="w-6 h-6 text-yellow-600 dark:text-yellow-400 mr-3 mt-1 flex-shrink-0"></i>
            <div>
                <h3 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">Important Medical Disclaimer</h3>
                <p class="text-yellow-700 dark:text-yellow-300 text-sm leading-relaxed">
                    This assessment is for informational purposes only and should not replace professional medical advice. 
                    If you are experiencing severe symptoms, persistent symptoms, or are concerned about your health, 
                    please consult with a qualified healthcare provider immediately. In case of emergency, contact your local emergency services.
                </p>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="{{ url_for('feedback', submission_id=submission.id) }}" 
           class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center">
            <i data-feather="message-circle" class="w-5 h-5 mr-2"></i>
            Provide Feedback
        </a>
        
        <a href="{{ url_for('index') }}" 
           class="bg-gradient-to-r from-ice-600 to-ice-700 hover:from-ice-700 hover:to-ice-800 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center">
            <i data-feather="plus" class="w-5 h-5 mr-2"></i>
            New Assessment
        </a>
        
        <a href="{{ url_for('history') }}" 
           class="bg-gradient-to-r from-winter-600 to-winter-700 hover:from-winter-700 hover:to-winter-800 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center">
            <i data-feather="clock" class="w-5 h-5 mr-2"></i>
            View History
        </a>
    </div>
</div>
{% endblock %}
